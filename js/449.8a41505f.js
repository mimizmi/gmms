"use strict";(self["webpackChunkgdmu_mentor_selection"]=self["webpackChunkgdmu_mentor_selection"]||[]).push([[449],{4267:function(e,l,a){a.d(l,{O:function(){return n}});var t=a(5720);function n(){return(0,t.A)({url:"/api/Grade/get-all",method:"get"})}},6830:function(e,l,a){a.r(l),a.d(l,{default:function(){return se}});a(4114),a(8992),a(4520),a(1454),a(7550);var t=a(6768),n=a(144),u=a(4232),r=a(8500),o=a(3555),i=a(9942),s=a(4267),d=a(1219),c=a(7477),v=a(1527),p=a.n(v);a(6573),a(8100),a(7936),a(7642),a(8004),a(3853),a(5876),a(2475),a(5024),a(1698),a(7467),a(4732),a(9577),a(3215),a(2577),a(670),a(3949),a(8872),a(4979),a(4603),a(7566),a(8721);function g(e){return!!(0,n.o5)()&&((0,n.jr)(e),!0)}function f(e){return"function"===typeof e?e():(0,n.R1)(e)}const b="undefined"!==typeof window&&"undefined"!==typeof document,_=("undefined"!==typeof WorkerGlobalScope&&(globalThis,WorkerGlobalScope),Object.prototype.toString),k=e=>"[object Object]"===_.call(e),m=()=>{};function y(e,l){function a(...a){return new Promise(((t,n)=>{Promise.resolve(e((()=>l.apply(this,a)),{fn:l,thisArg:this,args:a})).then(t).catch(n)}))}return a}const h=e=>e();function w(e=h){const l=(0,n.KR)(!0);function a(){l.value=!1}function t(){l.value=!0}const u=(...a)=>{l.value&&e(...a)};return{isActive:(0,n.tB)(l),pause:a,resume:t,eventFilter:u}}function F(e){const l=Object.create(null);return a=>{const t=l[a];return t||(l[a]=e(a))}}const C=/\B([A-Z])/g,R=(F((e=>e.replace(C,"-$1").toLowerCase())),/-(\w)/g);F((e=>e.replace(R,((e,l)=>l?l.toUpperCase():""))));function V(e){return e||(0,t.nI)()}function L(e,l,a={}){const{eventFilter:n=h,...u}=a;return(0,t.wB)(e,y(n,l),u)}function S(e,l,a={}){const{eventFilter:t,...n}=a,{eventFilter:u,pause:r,resume:o,isActive:i}=w(t),s=L(e,l,{...n,eventFilter:u});return{stop:s,pause:r,resume:o,isActive:i}}function W(e,l=!0,a){const n=V();n?(0,t.sV)(e,a):l?e():(0,t.dY)(e)}const I=b?window:void 0;b&&window.document,b&&window.navigator,b&&window.location;function K(e){var l;const a=f(e);return null!=(l=null==a?void 0:a.$el)?l:a}function E(...e){let l,a,n,u;if("string"===typeof e[0]||Array.isArray(e[0])?([a,n,u]=e,l=I):[l,a,n,u]=e,!l)return m;Array.isArray(a)||(a=[a]),Array.isArray(n)||(n=[n]);const r=[],o=()=>{r.forEach((e=>e())),r.length=0},i=(e,l,a,t)=>(e.addEventListener(l,a,t),()=>e.removeEventListener(l,a,t)),s=(0,t.wB)((()=>[K(l),f(u)]),(([e,l])=>{if(o(),!e)return;const t=k(l)?{...l}:l;r.push(...a.flatMap((l=>n.map((a=>i(e,l,a,t))))))}),{immediate:!0,flush:"post"}),d=()=>{s(),o()};return g(d),d}const j="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{},A="__vueuse_ssr_handlers__",X=N();function N(){return A in j||(j[A]=j[A]||{}),j[A]}function O(e,l){return X[e]||l}function x(e){return null==e?"any":e instanceof Set?"set":e instanceof Map?"map":e instanceof Date?"date":"boolean"===typeof e?"boolean":"string"===typeof e?"string":"object"===typeof e?"object":Number.isNaN(e)?"any":"number"}const z={boolean:{read:e=>"true"===e,write:e=>String(e)},object:{read:e=>JSON.parse(e),write:e=>JSON.stringify(e)},number:{read:e=>Number.parseFloat(e),write:e=>String(e)},any:{read:e=>e,write:e=>String(e)},string:{read:e=>e,write:e=>String(e)},map:{read:e=>new Map(JSON.parse(e)),write:e=>JSON.stringify(Array.from(e.entries()))},set:{read:e=>new Set(JSON.parse(e)),write:e=>JSON.stringify(Array.from(e))},date:{read:e=>new Date(e),write:e=>e.toISOString()}},U="vueuse-storage";function J(e,l,a,u={}){var r;const{flush:o="pre",deep:i=!0,listenToStorageChanges:s=!0,writeDefaults:d=!0,mergeDefaults:c=!1,shallow:v,window:p=I,eventFilter:g,onError:b=e=>{console.error(e)},initOnMounted:_}=u,k=(v?n.IJ:n.KR)("function"===typeof l?l():l);if(!a)try{a=O("getDefaultStorage",(()=>{var e;return null==(e=I)?void 0:e.localStorage}))()}catch(j){b(j)}if(!a)return k;const m=f(l),y=x(m),h=null!=(r=u.serializer)?r:z[y],{pause:w,resume:F}=S(k,(()=>R(k.value)),{flush:o,deep:i,eventFilter:g});function C(l,t){if(p){const n={key:e,oldValue:l,newValue:t,storageArea:a};p.dispatchEvent(a instanceof Storage?new StorageEvent("storage",n):new CustomEvent(U,{detail:n}))}}function R(l){try{const t=a.getItem(e);if(null==l)C(t,null),a.removeItem(e);else{const n=h.write(l);t!==n&&(a.setItem(e,n),C(t,n))}}catch(j){b(j)}}function V(l){const t=l?l.newValue:a.getItem(e);if(null==t)return d&&null!=m&&a.setItem(e,h.write(m)),m;if(!l&&c){const e=h.read(t);return"function"===typeof c?c(e,m):"object"!==y||Array.isArray(e)?e:{...m,...e}}return"string"!==typeof t?t:h.read(t)}function L(l){if(!l||l.storageArea===a)if(l&&null==l.key)k.value=m;else if(!l||l.key===e){w();try{(null==l?void 0:l.newValue)!==h.write(k.value)&&(k.value=V(l))}catch(j){b(j)}finally{l?(0,t.dY)(F):F()}}}function K(e){L(e.detail)}return p&&s&&W((()=>{a instanceof Storage?E(p,"storage",L):E(p,U,K),_&&L()})),_||L(),k}Number.POSITIVE_INFINITY;const B={class:"group-hall"},Q={class:"bar-container"},T={class:"filter-area"},D={class:"search-area"},M={class:"group-list"},P={class:"card-header"},G={class:"group-name"},$={class:"card-content"},Y={class:"group-title"},Z={class:"group-info"},q={class:"group-meta"},H={class:"card-footer"},ee={class:"pagination"},le={class:"drawer-header"},ae={class:"volunteer-list"},te={class:"volunteer-item"},ne={class:"volunteer-index"},ue={class:"group-name"};var re={__name:"group-hall",setup(e){const l=(0,r.k)(),a=(0,n.KR)(!1),v=(0,n.KR)(!1),g=(0,n.KR)([]),f=(0,n.KR)(""),b=(0,n.KR)(""),_=(0,n.KR)(!1),k=(0,n.KR)(null),m=(0,n.KR)([]),y=J("teacherSelectedGroups",[]),h=(0,n.KR)(!1),w=(0,n.KR)(!1),F=(0,n.KR)([]),C=(0,n.KR)(1),R=(0,n.KR)(9),V=(0,n.KR)(""),L=(0,n.KR)(!1),S=async()=>{try{const e=await(0,s.O)();F.value=e.map((e=>e.gde_value))}catch(e){console.error("获取年级列表失败:",e),d.nk.error("获取年级列表失败")}},W=async(e,t)=>{a.value=!0;try{let a;if(L.value)a=await(0,o.e1)(l.userInfo.tea_id),(e||t)&&(a=a.filter((l=>{const a=!e||l.grade===e,n=!t||l.major===t;return a&&n})));else{if(!e||!t)return;a=await(0,o.N_)(e,t)}g.value=a||[],C.value=1}catch(n){console.error("获取小组列表失败:",n),d.nk.error("获取小组列表失败"),g.value=[]}finally{a.value=!1}},I=async e=>{k.value=e,v.value=!0;try{const[l,a]=await Promise.all([(0,o.Qo)(e.group_id),(0,o.kQ)(e.group_id)]);Object.assign(k.value,l),m.value=a,_.value=!0}catch(l){d.nk.error("获取小组详情失败")}finally{v.value=!1}},K=e=>y.value.some((l=>l.group_id===e)),E=e=>{const l=y.value.findIndex((l=>l.group_id===e));return-1===l?"预选":`志愿${l+1}`},j=e=>{if(!K(e.group_id)){if(y.value.length>0){const l=y.value[0];if(l.grade!==e.grade||l.major!==e.major)return void d.nk.warning("只能预选同一个年级和专业的小组")}y.value.push(e),h.value=!0}},A=e=>{const l=y.value.findIndex((l=>l.group_id===e.group_id));l>-1&&y.value.splice(l,1)},X=async()=>{if(y.value.length){w.value=!0;try{await(0,i._L)(l.userInfo.tea_id,y.value.map((e=>e.group_id))),d.nk.success("预选成功"),h.value=!1}catch(e){d.nk.error("预选失败")}finally{w.value=!1}}else d.nk.warning("请至少选择一个小组")},N=()=>{C.value=1},O=e=>{R.value=e,C.value=1},x=e=>{C.value=e},z=()=>{(f.value&&b.value||L.value)&&W(f.value,b.value)},U=()=>{W(f.value,b.value)},re=()=>{k.value=null,m.value=[]},oe=()=>{L.value||f.value&&b.value?W(f.value,b.value):g.value=[]},ie=(0,t.EW)((()=>{if(!V.value)return g.value;const e=V.value.toLowerCase();return g.value.filter((l=>l.group_name.toLowerCase().includes(e)||l.group_title.toLowerCase().includes(e)))})),se=(0,t.EW)((()=>{const e=(C.value-1)*R.value,l=e+R.value;return ie.value.slice(e,l)}));return(0,t.sV)((async()=>{await S(),F.value.length&&(f.value=F.value[0]),l.userInfo?.tea_mjr?.length&&(b.value=l.userInfo.tea_mjr[0],W(f.value,b.value))})),(e,r)=>{const o=(0,t.g2)("el-checkbox"),i=(0,t.g2)("el-icon"),s=(0,t.g2)("el-input"),d=(0,t.g2)("el-option"),g=(0,t.g2)("el-select"),S=(0,t.g2)("el-button"),W=(0,t.g2)("el-card"),J=(0,t.g2)("el-empty"),de=(0,t.g2)("el-tag"),ce=(0,t.g2)("el-col"),ve=(0,t.g2)("el-row"),pe=(0,t.g2)("el-pagination"),ge=(0,t.g2)("el-descriptions-item"),fe=(0,t.g2)("el-descriptions"),be=(0,t.g2)("el-table-column"),_e=(0,t.g2)("el-table"),ke=(0,t.g2)("el-dialog"),me=(0,t.g2)("el-alert"),ye=(0,t.g2)("el-drawer"),he=(0,t.g2)("el-badge"),we=(0,t.gN)("loading");return(0,t.uX)(),(0,t.CE)("div",B,[(0,t.bF)(W,{class:"action-bar"},{default:(0,t.k6)((()=>[(0,t.Lk)("div",Q,[r[12]||(r[12]=(0,t.Lk)("div",{class:"bar-title"},[(0,t.Lk)("h2",null,"小组大厅")],-1)),(0,t.Lk)("div",T,[(0,t.bF)(o,{modelValue:L.value,"onUpdate:modelValue":r[0]||(r[0]=e=>L.value=e),onChange:oe,style:{"margin-right":"20px"}},{default:(0,t.k6)((()=>r[10]||(r[10]=[(0,t.eW)(" 只看预选我的 ")]))),_:1},8,["modelValue"]),(0,t.Lk)("div",D,[(0,t.bF)(s,{modelValue:V.value,"onUpdate:modelValue":r[1]||(r[1]=e=>V.value=e),placeholder:"搜索小组名称/选题",clearable:"",onClear:N,style:{width:"240px"}},{prefix:(0,t.k6)((()=>[(0,t.bF)(i,null,{default:(0,t.k6)((()=>[(0,t.bF)((0,n.R1)(c.vji))])),_:1})])),_:1},8,["modelValue"])]),(0,t.bF)(g,{modelValue:f.value,"onUpdate:modelValue":r[2]||(r[2]=e=>f.value=e),placeholder:"选择年级",clearable:"",onChange:z,disabled:a.value},{default:(0,t.k6)((()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(F.value,(e=>((0,t.uX)(),(0,t.Wv)(d,{key:e,label:`${e}级`,value:e},null,8,["label","value"])))),128))])),_:1},8,["modelValue","disabled"]),(0,t.bF)(g,{modelValue:b.value,"onUpdate:modelValue":r[3]||(r[3]=e=>b.value=e),placeholder:"选择专业",clearable:"",onChange:z,disabled:a.value,style:{width:"240px"}},{default:(0,t.k6)((()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)((0,n.R1)(l).userInfo?.tea_mjr,(e=>((0,t.uX)(),(0,t.Wv)(d,{key:e,label:e,value:e},null,8,["label","value"])))),128))])),_:1},8,["modelValue","disabled"]),(0,t.bF)(S,{onClick:U,loading:a.value},{default:(0,t.k6)((()=>[(0,t.bF)(i,null,{default:(0,t.k6)((()=>[(0,t.bF)((0,n.R1)(c.C42))])),_:1}),r[11]||(r[11]=(0,t.eW)(" 刷新 "))])),_:1},8,["loading"])])])])),_:1}),(0,t.bo)(((0,t.uX)(),(0,t.CE)("div",M,[ie.value.length?((0,t.uX)(),(0,t.CE)(t.FK,{key:1},[se.value.length?((0,t.uX)(),(0,t.Wv)(ve,{key:0,gutter:20},{default:(0,t.k6)((()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(se.value,(e=>((0,t.uX)(),(0,t.Wv)(ce,{span:8,key:e.group_id},{default:(0,t.k6)((()=>[(0,t.bF)(W,{class:"group-card",shadow:"hover"},{header:(0,t.k6)((()=>[(0,t.Lk)("div",P,[(0,t.Lk)("span",G,(0,u.v_)(e.group_name),1),(0,t.bF)(de,{size:"small",type:"success"},{default:(0,t.k6)((()=>[(0,t.eW)((0,u.v_)(e.group_id)+"号小组",1)])),_:2},1024)])])),default:(0,t.k6)((()=>[(0,t.Lk)("div",$,[(0,t.Lk)("h4",Y,(0,u.v_)(e.group_title),1),(0,t.Lk)("p",Z,(0,u.v_)(e.group_info),1),(0,t.Lk)("div",q,[(0,t.bF)(de,{size:"small"},{default:(0,t.k6)((()=>[(0,t.eW)((0,u.v_)(e.major),1)])),_:2},1024),(0,t.bF)(de,{size:"small",type:"info"},{default:(0,t.k6)((()=>[(0,t.eW)((0,u.v_)(e.grade)+"级",1)])),_:2},1024)]),(0,t.Lk)("div",H,[(0,t.bF)(S,{type:"primary",link:"",onClick:l=>I(e)},{default:(0,t.k6)((()=>r[13]||(r[13]=[(0,t.eW)(" 查看详情 ")]))),_:2},1032,["onClick"]),(0,t.bF)(S,{type:"success",link:"",onClick:l=>j(e),disabled:K(e.group_id)},{default:(0,t.k6)((()=>[(0,t.eW)((0,u.v_)(E(e.group_id)),1)])),_:2},1032,["onClick","disabled"])])])])),_:2},1024)])),_:2},1024)))),128))])),_:1})):(0,t.Q3)("",!0),(0,t.Lk)("div",ee,[(0,t.bF)(pe,{"current-page":C.value,"onUpdate:currentPage":r[4]||(r[4]=e=>C.value=e),"page-size":R.value,"onUpdate:pageSize":r[5]||(r[5]=e=>R.value=e),total:ie.value.length,"page-sizes":[9,18,27,36],layout:"total, sizes, prev, pager, next, jumper",onSizeChange:O,onCurrentChange:x},null,8,["current-page","page-size","total"])])],64)):((0,t.uX)(),(0,t.Wv)(J,{key:0,description:"暂无小组"}))])),[[we,a.value]]),(0,t.bF)(ke,{modelValue:_.value,"onUpdate:modelValue":r[6]||(r[6]=e=>_.value=e),title:"小组详情",width:"50%",onClosed:re},{default:(0,t.k6)((()=>[(0,t.bo)(((0,t.uX)(),(0,t.CE)("div",null,[k.value?((0,t.uX)(),(0,t.CE)(t.FK,{key:0},[(0,t.bF)(fe,{column:2,border:""},{default:(0,t.k6)((()=>[(0,t.bF)(ge,{label:"小组名称"},{default:(0,t.k6)((()=>[(0,t.eW)((0,u.v_)(k.value.group_name),1)])),_:1}),(0,t.bF)(ge,{label:"小组编号"},{default:(0,t.k6)((()=>[(0,t.eW)((0,u.v_)(k.value.group_id),1)])),_:1}),(0,t.bF)(ge,{label:"选题"},{default:(0,t.k6)((()=>[(0,t.eW)((0,u.v_)(k.value.group_title),1)])),_:1}),(0,t.bF)(ge,{label:"描述",class:"group-description"},{default:(0,t.k6)((()=>[(0,t.eW)((0,u.v_)(k.value.group_info),1)])),_:1})])),_:1}),m.value.length?((0,t.uX)(),(0,t.CE)(t.FK,{key:0},[r[14]||(r[14]=(0,t.Lk)("h4",{class:"member-title"},"小组成员",-1)),(0,t.bF)(_e,{data:m.value,stripe:"",style:{width:"100%"}},{default:(0,t.k6)((()=>[(0,t.bF)(be,{prop:"stu_name",label:"姓名"}),(0,t.bF)(be,{prop:"stu_num",label:"学号"}),(0,t.bF)(be,{prop:"stu_cls",label:"班级"}),(0,t.bF)(be,{prop:"stu_phone",label:"联系方式"}),(0,t.bF)(be,{label:"身份"},{default:(0,t.k6)((e=>[(0,t.bF)(de,{type:e.row.stu_lead?"success":""},{default:(0,t.k6)((()=>[(0,t.eW)((0,u.v_)(e.row.stu_lead?"组长":"组员"),1)])),_:2},1032,["type"])])),_:1})])),_:1},8,["data"])],64)):(0,t.Q3)("",!0)],64)):(0,t.Q3)("",!0)])),[[we,v.value]])])),_:1},8,["modelValue"]),(0,t.bF)(ye,{modelValue:h.value,"onUpdate:modelValue":r[8]||(r[8]=e=>h.value=e),title:"预选志愿列表",size:"400px"},{header:(0,t.k6)((()=>[(0,t.Lk)("div",le,[r[16]||(r[16]=(0,t.Lk)("span",null,"预选志愿列表",-1)),(0,t.bF)(S,{type:"primary",onClick:X,loading:w.value},{default:(0,t.k6)((()=>r[15]||(r[15]=[(0,t.eW)(" 保存志愿 ")]))),_:1},8,["loading"])])])),default:(0,t.k6)((()=>[(0,t.Lk)("div",ae,[(0,n.R1)(y).length?((0,t.uX)(),(0,t.CE)(t.FK,{key:1},[(0,t.bF)(me,{type:"info",closable:!1,"show-icon":""},{default:(0,t.k6)((()=>r[17]||(r[17]=[(0,t.eW)(" 拖动调整志愿顺序，排在前面的优先级更高 ")]))),_:1}),(0,t.bF)((0,n.R1)(p()),{modelValue:(0,n.R1)(y),"onUpdate:modelValue":r[7]||(r[7]=e=>(0,n.i9)(y)?y.value=e:null),"item-key":"group_id",handle:".drag-handle","ghost-class":"ghost"},{item:(0,t.k6)((({element:e,index:l})=>[(0,t.Lk)("div",te,[(0,t.bF)(i,{class:"drag-handle"},{default:(0,t.k6)((()=>[(0,t.bF)((0,n.R1)(c.rgM))])),_:1}),(0,t.Lk)("span",ne,"志愿"+(0,u.v_)(l+1),1),(0,t.Lk)("span",ue,(0,u.v_)(e.group_name),1),(0,t.bF)(S,{type:"danger",link:"",onClick:l=>A(e)},{default:(0,t.k6)((()=>r[18]||(r[18]=[(0,t.eW)(" 移除 ")]))),_:2},1032,["onClick"])])])),_:1},8,["modelValue"])],64)):((0,t.uX)(),(0,t.Wv)(J,{key:0,description:"暂无预选小组"}))])])),_:1},8,["modelValue"]),(0,n.R1)(y).length?((0,t.uX)(),(0,t.Wv)(S,{key:0,class:"floating-button",type:"primary",circle:"",onClick:r[9]||(r[9]=e=>h.value=!0)},{default:(0,t.k6)((()=>[(0,t.bF)(he,{value:(0,n.R1)(y).length,max:99},{default:(0,t.k6)((()=>[(0,t.bF)(i,null,{default:(0,t.k6)((()=>[(0,t.bF)((0,n.R1)(c.B8B))])),_:1})])),_:1},8,["value"])])),_:1})):(0,t.Q3)("",!0)])}}},oe=a(1241);const ie=(0,oe.A)(re,[["__scopeId","data-v-b094cf1a"]]);var se=ie}}]);
//# sourceMappingURL=449.8a41505f.js.map