{"version":3,"file":"js/460.9cc3a90a.js","mappings":"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","sources":["webpack://gdmu-mentor-selection/./node_modules/vue-loader/dist/exportHelper.js","webpack://gdmu-mentor-selection/./src/api/major.js","webpack://gdmu-mentor-selection/./src/views/admin/manage/teacher-manage.vue","webpack://gdmu-mentor-selection/./src/views/admin/manage/teacher-manage.vue?66d4"],"sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n// runtime helper for setting properties on components\n// in a tree-shakable way\nexports.default = (sfc, props) => {\n    const target = sfc.__vccOpts || sfc;\n    for (const [key, val] of props) {\n        target[key] = val;\n    }\n    return target;\n};\n","import request from '@/utils/request'\r\n\r\n// 获取所有专业\r\nexport function getAllMajors() {\r\n  return request({\r\n    url: '/api/Major/get-all',\r\n    method: 'get'\r\n  })\r\n} ","<template>\r\n  <div class=\"teacher-manage\">\r\n    <div class=\"page-header\">\r\n      <h2>教师管理</h2>\r\n      <div class=\"header-desc\">管理所有教师信息，支持修改信息和添加教师</div>\r\n    </div>\r\n\r\n    <div class=\"filter-section\">\r\n      <el-form :inline=\"true\" :model=\"filterForm\" class=\"filter-form\">\r\n        <div class=\"filter-content\">\r\n          <el-form-item label=\"专业\">\r\n            <el-select \r\n              v-model=\"filterForm.major\" \r\n              clearable \r\n              placeholder=\"选择专业\"\r\n              style=\"width: 240px\"\r\n            >\r\n              <el-option\r\n                v-for=\"major in majors\"\r\n                :key=\"major.mjr_id\"\r\n                :label=\"major.mjr_name\"\r\n                :value=\"major.mjr_name\"\r\n              />\r\n            </el-select>\r\n          </el-form-item>\r\n          <el-form-item label=\"搜索\">\r\n            <el-input\r\n              v-model=\"filterForm.keyword\"\r\n              placeholder=\"搜索教师姓名\"\r\n              clearable\r\n              style=\"width: 200px\"\r\n            >\r\n              <template #prefix>\r\n                <el-icon><Search /></el-icon>\r\n              </template>\r\n            </el-input>\r\n          </el-form-item>\r\n        </div>\r\n        <div class=\"filter-actions\">\r\n          <el-form-item class=\"flex-auto\">\r\n            <el-button type=\"primary\" @click=\"handleSearch\">\r\n              <el-icon><Search /></el-icon>\r\n              搜索\r\n            </el-button>\r\n            <el-button type=\"success\" @click=\"resetFilter\">\r\n              <el-icon><Refresh /></el-icon>\r\n              重置筛选\r\n            </el-button>\r\n            <el-button type=\"primary\" @click=\"getData\">\r\n              <el-icon><Refresh /></el-icon>\r\n              刷新数据\r\n            </el-button>\r\n          </el-form-item>\r\n          <el-form-item>\r\n            <el-button type=\"success\" @click=\"handleAdd\">\r\n              <el-icon><Plus /></el-icon>\r\n              添加教师\r\n            </el-button>\r\n          </el-form-item>\r\n        </div>\r\n      </el-form>\r\n    </div>\r\n\r\n    <el-table\r\n      :data=\"currentPageData\"\r\n      stripe\r\n      v-loading=\"loading\"\r\n      style=\"width: 100%\"\r\n      :header-cell-style=\"{\r\n        background: '#fafafa',\r\n        color: '#606266',\r\n        fontWeight: 600\r\n      }\"\r\n      :cell-style=\"{\r\n        padding: '12px 0',\r\n        fontSize: '14px'\r\n      }\"\r\n      border\r\n    >\r\n      <el-table-column prop=\"tea_id\" label=\"ID\" width=\"80\" />\r\n      <el-table-column prop=\"tea_name\" label=\"姓名\" width=\"120\" />\r\n      <el-table-column label=\"所属专业\" min-width=\"200\">\r\n        <template #default=\"{ row }\">\r\n          <el-tag \r\n            v-for=\"major in row.tea_mjr\" \r\n            :key=\"major\"\r\n            style=\"margin-right: 4px\"\r\n          >\r\n            {{ major }}\r\n          </el-tag>\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column prop=\"tea_phone\" label=\"联系方式\" width=\"120\" />\r\n      <el-table-column prop=\"tea_info\" label=\"个人介绍\" min-width=\"200\" show-overflow-tooltip />\r\n      <el-table-column label=\"操作\" width=\"200\" fixed=\"right\">\r\n        <template #default=\"{ row }\">\r\n          <el-button \r\n            type=\"primary\" \r\n            link\r\n            @click=\"handleEdit(row)\"\r\n          >\r\n            编辑\r\n          </el-button>\r\n          <el-button \r\n            type=\"warning\" \r\n            link\r\n            @click=\"handleResetPassword(row)\"\r\n          >\r\n            重置密码\r\n          </el-button>\r\n          <el-button \r\n            type=\"danger\" \r\n            link\r\n            @click=\"handleDelete(row)\"\r\n          >\r\n            删除\r\n          </el-button>\r\n        </template>\r\n      </el-table-column>\r\n    </el-table>\r\n\r\n    <div class=\"pagination\">\r\n      <el-pagination\r\n        v-model:current-page=\"currentPage\"\r\n        v-model:page-size=\"pageSize\"\r\n        :total=\"filteredTeachers.length\"\r\n        :page-sizes=\"[10, 20, 30, 50]\"\r\n        layout=\"total, sizes, prev, pager, next, jumper\"\r\n        @size-change=\"handleSizeChange\"\r\n        @current-change=\"handleCurrentChange\"\r\n      />\r\n    </div>\r\n\r\n    <!-- 编辑/添加对话框 -->\r\n    <el-dialog\r\n      v-model=\"dialogVisible\"\r\n      :title=\"isEdit ? '编辑教师信息' : '添加教师'\"\r\n      width=\"50%\"\r\n    >\r\n      <el-form\r\n        ref=\"formRef\"\r\n        :model=\"form\"\r\n        :rules=\"rules\"\r\n        label-width=\"100px\"\r\n      >\r\n        <el-form-item label=\"姓名\" prop=\"tea_name\">\r\n          <el-input v-model=\"form.tea_name\" />\r\n        </el-form-item>\r\n        <el-form-item label=\"所属专业\" prop=\"tea_mjr\">\r\n          <el-select \r\n            v-model=\"form.tea_mjr\" \r\n            multiple \r\n            style=\"width: 100%\"\r\n            placeholder=\"请选择专业\"\r\n          >\r\n            <el-option\r\n              v-for=\"major in majors\"\r\n              :key=\"major.mjr_id\"\r\n              :label=\"major.mjr_name\"\r\n              :value=\"major.mjr_name\"\r\n            />\r\n          </el-select>\r\n        </el-form-item>\r\n        <el-form-item label=\"联系方式\" prop=\"tea_phone\">\r\n          <el-input v-model=\"form.tea_phone\" />\r\n        </el-form-item>\r\n        <el-form-item label=\"个人介绍\" prop=\"tea_info\">\r\n          <el-input \r\n            v-model=\"form.tea_info\" \r\n            type=\"textarea\" \r\n            :rows=\"4\"\r\n            placeholder=\"请输入个人介绍\"\r\n          />\r\n        </el-form-item>\r\n      </el-form>\r\n      <template #footer>\r\n        <el-button @click=\"dialogVisible = false\">取消</el-button>\r\n        <el-button \r\n          type=\"primary\" \r\n          @click=\"submitForm\"\r\n          :loading=\"submitLoading\"\r\n        >\r\n          确定\r\n        </el-button>\r\n      </template>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, reactive, computed, onMounted } from 'vue'\r\nimport { getAllTeachers, addTeacher, updateTeacherInfoByAdmin, resetTeacherPassword, deleteTeacher } from '@/api/teacher'\r\nimport { getAllMajors } from '@/api/major'\r\nimport { ElMessage, ElMessageBox } from 'element-plus'\r\nimport { Search, Refresh, Plus } from '@element-plus/icons-vue'\r\n\r\nconst loading = ref(false)\r\nconst submitLoading = ref(false)\r\nconst teachers = ref([])\r\nconst majors = ref([])\r\nconst dialogVisible = ref(false)\r\nconst isEdit = ref(false)\r\nconst formRef = ref(null)\r\n\r\n// 筛选表单\r\nconst filterForm = reactive({\r\n  major: '',\r\n  keyword: ''\r\n})\r\n\r\n// 分页相关\r\nconst currentPage = ref(1)\r\nconst pageSize = ref(10)\r\n\r\n// 表单数据\r\nconst form = reactive({\r\n  tea_id: '',\r\n  tea_name: '',\r\n  tea_mjr: [],\r\n  tea_phone: '',\r\n  tea_info: ''\r\n})\r\n\r\n// 表单验证规则\r\nconst rules = {\r\n  tea_name: [\r\n    { required: true, message: '请输入教师姓名', trigger: 'blur' }\r\n  ],\r\n  tea_mjr: [\r\n    { required: true, message: '请选择至少一个专业', trigger: 'change' }\r\n  ],\r\n  tea_phone: [\r\n    { pattern: /^1[3-9]\\d{9}$/, message: '请输入正确的手机号码', trigger: 'blur' }\r\n  ]\r\n}\r\n\r\n// 过滤后的教师列表\r\nconst filteredTeachers = computed(() => {\r\n  let result = [...teachers.value]\r\n  \r\n  if (filterForm.major) {\r\n    result = result.filter(teacher => \r\n      teacher.tea_mjr.includes(filterForm.major)\r\n    )\r\n  }\r\n  \r\n  if (filterForm.keyword) {\r\n    const keyword = filterForm.keyword.toLowerCase()\r\n    result = result.filter(teacher => \r\n      teacher.tea_name.toLowerCase().includes(keyword)\r\n    )\r\n  }\r\n  \r\n  return result\r\n})\r\n\r\n// 当前页数据\r\nconst currentPageData = computed(() => {\r\n  const start = (currentPage.value - 1) * pageSize.value\r\n  const end = start + pageSize.value\r\n  return filteredTeachers.value.slice(start, end)\r\n})\r\n\r\n// 获取所有数据\r\nconst getData = async () => {\r\n  loading.value = true\r\n  try {\r\n    const [teachersData, majorsData] = await Promise.all([\r\n      getAllTeachers(),\r\n      getAllMajors()\r\n    ])\r\n    teachers.value = teachersData\r\n    majors.value = majorsData\r\n  } catch (error) {\r\n    ElMessage.error('获取数据失败')\r\n  } finally {\r\n    loading.value = false\r\n  }\r\n}\r\n\r\n// 搜索\r\nconst handleSearch = () => {\r\n  currentPage.value = 1\r\n}\r\n\r\n// 重置筛选\r\nconst resetFilter = () => {\r\n  filterForm.major = ''\r\n  filterForm.keyword = ''\r\n  currentPage.value = 1\r\n}\r\n\r\n// 添加教师\r\nconst handleAdd = () => {\r\n  isEdit.value = false\r\n  Object.assign(form, {\r\n    tea_id: '',\r\n    tea_name: '',\r\n    tea_mjr: [],\r\n    tea_phone: '',\r\n    tea_info: ''\r\n  })\r\n  dialogVisible.value = true\r\n}\r\n\r\n// 编辑教师\r\nconst handleEdit = (row) => {\r\n  isEdit.value = true\r\n  Object.assign(form, row)\r\n  dialogVisible.value = true\r\n}\r\n\r\n// 提交表单\r\nconst submitForm = async () => {\r\n  if (!formRef.value) return\r\n  \r\n  try {\r\n    await formRef.value.validate()\r\n    submitLoading.value = true\r\n\r\n    const submitData = {\r\n      tea_name: form.tea_name,\r\n      tea_mjr: form.tea_mjr,\r\n      tea_phone: form.tea_phone || '',\r\n      tea_info: form.tea_info || ''\r\n    }\r\n\r\n    if (isEdit.value) {\r\n      await updateTeacherInfoByAdmin(form.tea_id, submitData)\r\n      ElMessage.success('修改成功')\r\n    } else {\r\n      await addTeacher(submitData)\r\n      ElMessage.success('添加成功')\r\n    }\r\n\r\n    dialogVisible.value = false\r\n    getData()\r\n  } catch (error) {\r\n    ElMessage.error(error.message || (isEdit.value ? '修改失败' : '添加失败'))\r\n  } finally {\r\n    submitLoading.value = false\r\n  }\r\n}\r\n\r\n// 分页处理\r\nconst handleSizeChange = (val) => {\r\n  pageSize.value = val\r\n  currentPage.value = 1\r\n}\r\n\r\nconst handleCurrentChange = (val) => {\r\n  currentPage.value = val\r\n}\r\n\r\n// 重置密码\r\nconst handleResetPassword = async (row) => {\r\n  try {\r\n    await ElMessageBox.confirm(\r\n      `确定要将教师 ${row.tea_name} 的密码重置为 gdmu 吗？`,\r\n      '提示',\r\n      {\r\n        confirmButtonText: '确定',\r\n        cancelButtonText: '取消',\r\n        type: 'warning'\r\n      }\r\n    )\r\n    \r\n    await resetTeacherPassword(row.tea_id, 'gdmu')\r\n    ElMessage.success('密码重置成功')\r\n  } catch (error) {\r\n    if (error !== 'cancel') {\r\n      ElMessage.error('密码重置失败')\r\n    }\r\n  }\r\n}\r\n\r\n// 删除教师\r\nconst handleDelete = async (row) => {\r\n  try {\r\n    await ElMessageBox.confirm(\r\n      `确定要删除教师 ${row.tea_name} 吗？此操作不可恢复！`,\r\n      '警告',\r\n      {\r\n        confirmButtonText: '确定',\r\n        cancelButtonText: '取消',\r\n        type: 'warning'\r\n      }\r\n    )\r\n    \r\n    await deleteTeacher(row.tea_id)\r\n    ElMessage.success('删除成功')\r\n    getData()\r\n  } catch (error) {\r\n    if (error !== 'cancel') {\r\n      ElMessage.error('删除失败')\r\n    }\r\n  }\r\n}\r\n\r\nonMounted(() => {\r\n  getData()\r\n})\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.teacher-manage {\r\n  .page-header {\r\n    margin-bottom: 20px;\r\n    padding: 20px;\r\n    background: #fff;\r\n    border-radius: 4px;\r\n    box-shadow: 0 2px 12px 0 rgba(0,0,0,0.1);\r\n\r\n    h2 {\r\n      margin: 0;\r\n      color: #1890ff;\r\n      font-size: 24px;\r\n      margin-bottom: 8px;\r\n    }\r\n\r\n    .header-desc {\r\n      color: #909399;\r\n      font-size: 14px;\r\n    }\r\n  }\r\n\r\n  .filter-section {\r\n    margin-bottom: 20px;\r\n    padding: 20px;\r\n    background: #fff;\r\n    border-radius: 4px;\r\n    box-shadow: 0 2px 12px 0 rgba(0,0,0,0.1);\r\n\r\n    .filter-form {\r\n      display: flex;\r\n      align-items: center;\r\n      flex-wrap: wrap;\r\n\r\n      .el-form-item {\r\n        margin-bottom: 0;\r\n        margin-right: 10px;\r\n\r\n        &.flex-auto {\r\n          margin-left: auto;\r\n          margin-right: 0;\r\n        }\r\n\r\n        .el-button {\r\n          margin-left: 8px;\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  :deep(.el-table) {\r\n    border-radius: 8px;\r\n    overflow: hidden;\r\n    \r\n    .el-table__header-wrapper {\r\n      th {\r\n        border-bottom: 2px solid #ebeef5;\r\n      }\r\n    }\r\n    \r\n    .el-table__body-wrapper {\r\n      td {\r\n        border-bottom: 1px solid #ebeef5;\r\n      }\r\n    }\r\n    \r\n    .el-table__row:hover > td {\r\n      background: #f5f7fa !important;\r\n    }\r\n  }\r\n\r\n  .pagination {\r\n    margin-top: 20px;\r\n    display: flex;\r\n    justify-content: flex-end;\r\n  }\r\n}\r\n</style> ","import script from \"./teacher-manage.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./teacher-manage.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./teacher-manage.vue?vue&type=style&index=0&id=969233da&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-969233da\"]])\n\nexport default __exports__"],"names":["exports","sfc","props","target","__vccOpts","key","val","getAllMajors","request","url","method","loading","ref","submitLoading","teachers","majors","dialogVisible","isEdit","formRef","filterForm","reactive","major","keyword","currentPage","pageSize","form","tea_id","tea_name","tea_mjr","tea_phone","tea_info","rules","required","message","trigger","pattern","filteredTeachers","computed","result","value","filter","teacher","includes","toLowerCase","currentPageData","start","end","slice","getData","async","teachersData","majorsData","Promise","all","getAllTeachers","error","ElMessage","handleSearch","resetFilter","handleAdd","Object","assign","handleEdit","row","submitForm","validate","submitData","updateTeacherInfoByAdmin","success","addTeacher","handleSizeChange","handleCurrentChange","handleResetPassword","ElMessageBox","confirm","confirmButtonText","cancelButtonText","type","resetTeacherPassword","handleDelete","deleteTeacher","onMounted","__exports__"],"sourceRoot":""}