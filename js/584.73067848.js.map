{"version":3,"file":"js/584.73067848.js","mappings":"uIAIAA,EAAQ,EAAU,CAACC,EAAKC,KACpB,MAAMC,EAASF,EAAIG,WAAaH,EAChC,IAAK,MAAOI,EAAKC,KAAQJ,EACrBC,EAAOE,GAAOC,EAElB,OAAOH,CAAM,C,oOCsGjB,MAAMI,GAAYC,EAAAA,EAAAA,KACZC,GAASC,EAAAA,EAAAA,MACTC,GAAUC,EAAAA,EAAAA,KAAI,GACdC,GAAkBD,EAAAA,EAAAA,KAAI,GACtBE,GAAYF,EAAAA,EAAAA,KAAI,GAChBG,GAAcH,EAAAA,EAAAA,IAAI,MAClBI,GAAkBJ,EAAAA,EAAAA,IAAI,MAGtBK,EAAS,CACb,YACA,OACA,OACA,MACA,QAIIC,GAAWC,EAAAA,EAAAA,IAAS,IACrBZ,EAAUa,WAGTC,EAAY,CAChBC,UAAW,CACT,CAAEC,UAAU,EAAMC,QAAS,UAAWC,QAAS,QAC/C,CAAEC,QAAS,gBAAiBF,QAAS,aAAcC,QAAS,SAE9DE,SAAU,CACR,CAAEC,IAAK,IAAKJ,QAAS,iBAAkBC,QAAS,SAElDI,QAAS,CACP,CAAEN,UAAU,EAAMC,QAAS,YAAaC,QAAS,YAK/CK,GAAeX,EAAAA,EAAAA,IAAS,CAC5BY,YAAa,GACbC,gBAAiB,KAGbC,EAAgB,CACpBF,YAAa,CACX,CAAER,UAAU,EAAMC,QAAS,SAAUC,QAAS,QAC9C,CAAES,IAAK,EAAGV,QAAS,aAAcC,QAAS,SAE5CO,gBAAiB,CACf,CAAET,UAAU,EAAMC,QAAS,WAAYC,QAAS,QAChD,CACEU,UAAWA,CAACC,EAAMC,EAAOC,KACnBD,IAAUP,EAAaC,YACzBO,EAAS,IAAIC,MAAM,eAEnBD,GACF,EAEFb,QAAS,UAMTe,EAAaA,KACjB1B,EAAUuB,OAAQ,CAAI,EAGlBI,EAAaA,KACjB3B,EAAUuB,OAAQ,EAClBK,OAAOC,OAAOzB,EAAUX,EAAUa,SAAS,EAGvCwB,EAAaC,UACjB,GAAK9B,EAAYsB,MAEjB,UACQtB,EAAYsB,MAAMS,WACxBnC,EAAQ0B,OAAQ,EAChB,MAAMU,QAAYC,EAAAA,EAAAA,IAAkBzC,EAAUa,SAAS6B,OAAQ/B,GAC/DgC,EAAAA,GAAUC,QAAQ,QAClB5C,EAAUa,SAAW2B,GACrBK,EAAAA,EAAAA,IAAU,WAAYC,KAAKC,UAAUP,IACrCjC,EAAUuB,OAAQ,CACpB,CAAE,MAAOkB,GACPL,EAAAA,GAAUK,MAAM,OAClB,CAAE,QACA5C,EAAQ0B,OAAQ,CAClB,GAIImB,EAAiBX,UACrB,GAAK7B,EAAgBqB,MAErB,UACQrB,EAAgBqB,MAAMS,WAC5BjC,EAAgBwB,OAAQ,QAClBoB,EAAAA,EAAAA,IAAsBlD,EAAUa,SAAS6B,OAAQnB,EAAaC,aAEpED,EAAaC,YAAc,GAC3BD,EAAaE,gBAAkB,GAC/BhB,EAAgBqB,MAAMqB,oBAGhBC,EAAAA,EAAaC,MACjB,kCACA,KACA,CACEC,KAAM,UACNC,WAAW,EACXC,kBAAmB,OAIvBxD,EAAUyD,SACVvD,EAAOwD,KAAK,iBACd,CAAE,MAAOV,GACPL,EAAAA,GAAUK,MAAM,SAClB,CAAE,QACA1C,EAAgBwB,OAAQ,CAC1B,GAGI6B,GAAYtD,EAAAA,EAAAA,IAAI,Q,qjGCnOtB,MAAMuD,GAA2B,OAAgB,EAAQ,CAAC,CAAC,YAAY,qBAEvE,O","sources":["webpack://gdmu-mentor-selection/./node_modules/vue-loader/dist/exportHelper.js","webpack://gdmu-mentor-selection/./src/views/teacher/teacher-settings.vue","webpack://gdmu-mentor-selection/./src/views/teacher/teacher-settings.vue?750d"],"sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n// runtime helper for setting properties on components\n// in a tree-shakable way\nexports.default = (sfc, props) => {\n    const target = sfc.__vccOpts || sfc;\n    for (const [key, val] of props) {\n        target[key] = val;\n    }\n    return target;\n};\n","<template>\r\n  <div class=\"settings\">\r\n    <el-card>\r\n      <template #header>\r\n        <div class=\"card-header\">\r\n          <h3>个人设置</h3>\r\n        </div>\r\n      </template>\r\n\r\n      <el-tabs v-model=\"activeTab\">\r\n        <!-- 个人信息设置 -->\r\n        <el-tab-pane label=\"信息设置\" name=\"info\">\r\n          <el-form \r\n            ref=\"infoFormRef\"\r\n            :model=\"infoForm\"\r\n            :rules=\"infoRules\"\r\n            label-width=\"100px\"\r\n          >\r\n            <el-form-item label=\"姓名\">\r\n              <el-input v-model=\"infoForm.tea_name\" disabled />\r\n            </el-form-item>\r\n            <el-form-item label=\"联系方式\" prop=\"tea_phone\">\r\n              <el-input v-model=\"infoForm.tea_phone\" :disabled=\"!isEditing\" />\r\n            </el-form-item>\r\n            <el-form-item label=\"个人介绍\" prop=\"tea_info\">\r\n              <el-input \r\n                v-model=\"infoForm.tea_info\" \r\n                type=\"textarea\" \r\n                :rows=\"4\"\r\n                placeholder=\"请输入个人介绍\"\r\n                :disabled=\"!isEditing\"\r\n              />\r\n            </el-form-item>\r\n            <el-form-item label=\"所属专业\">\r\n              <el-select \r\n                v-model=\"infoForm.tea_mjr\" \r\n                multiple \r\n                placeholder=\"请选择专业\"\r\n                style=\"width: 100%\"\r\n                disabled\r\n              >\r\n                <el-option\r\n                  v-for=\"major in majors\"\r\n                  :key=\"major\"\r\n                  :label=\"major\"\r\n                  :value=\"major\"\r\n                />\r\n              </el-select>\r\n            </el-form-item>\r\n            <el-form-item>\r\n              <el-button type=\"primary\" @click=\"handleEdit\" v-if=\"!isEditing\">\r\n                修改信息\r\n              </el-button>\r\n              <template v-else>\r\n                <el-button @click=\"cancelEdit\">取消</el-button>\r\n                <el-button type=\"primary\" @click=\"submitEdit\" :loading=\"loading\">\r\n                  保存\r\n                </el-button>\r\n              </template>\r\n            </el-form-item>\r\n          </el-form>\r\n        </el-tab-pane>\r\n\r\n        <!-- 密码设置 -->\r\n        <el-tab-pane label=\"密码设置\" name=\"password\">\r\n          <el-form \r\n            ref=\"passwordFormRef\"\r\n            :model=\"passwordForm\"\r\n            :rules=\"passwordRules\"\r\n            label-width=\"100px\"\r\n          >\r\n            <el-form-item label=\"新密码\" prop=\"newPassword\">\r\n              <el-input \r\n                v-model=\"passwordForm.newPassword\"\r\n                type=\"password\"\r\n                show-password\r\n                placeholder=\"请输入新密码\"\r\n              />\r\n            </el-form-item>\r\n            <el-form-item label=\"确认密码\" prop=\"confirmPassword\">\r\n              <el-input \r\n                v-model=\"passwordForm.confirmPassword\"\r\n                type=\"password\"\r\n                show-password\r\n                placeholder=\"请再次输入新密码\"\r\n              />\r\n            </el-form-item>\r\n            <el-form-item>\r\n              <el-button \r\n                type=\"primary\" \r\n                @click=\"submitPassword\"\r\n                :loading=\"passwordLoading\"\r\n              >\r\n                修改密码\r\n              </el-button>\r\n            </el-form-item>\r\n          </el-form>\r\n        </el-tab-pane>\r\n      </el-tabs>\r\n    </el-card>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, reactive } from 'vue'\r\nimport { useUserStore } from '@/store/modules/user'\r\nimport { updateTeacherInfo, updateTeacherPassword } from '@/api/teacher'\r\nimport { ElMessage, ElMessageBox } from 'element-plus'\r\nimport { setCookie } from '@/utils/cookie'\r\nimport { useRouter } from 'vue-router'\r\n\r\nconst userStore = useUserStore()\r\nconst router = useRouter()\r\nconst loading = ref(false)\r\nconst passwordLoading = ref(false)\r\nconst isEditing = ref(false)\r\nconst infoFormRef = ref(null)\r\nconst passwordFormRef = ref(null)\r\n\r\n// 专业列表（这里可以从后端获取或配置文件中读取）\r\nconst majors = [\r\n  '信息管理与信息系统',\r\n  '工商管理',\r\n  '市场营销',\r\n  '会计学',\r\n  '财务管理'\r\n]\r\n\r\n// 个人信息表单\r\nconst infoForm = reactive({\r\n  ...userStore.userInfo\r\n})\r\n\r\nconst infoRules = {\r\n  tea_phone: [\r\n    { required: true, message: '请输入联系方式', trigger: 'blur' },\r\n    { pattern: /^1[3-9]\\d{9}$/, message: '请输入正确的手机号码', trigger: 'blur' }\r\n  ],\r\n  tea_info: [\r\n    { max: 200, message: '个人介绍不能超过200个字符', trigger: 'blur' }\r\n  ],\r\n  tea_mjr: [\r\n    { required: true, message: '请选择至少一个专业', trigger: 'change' }\r\n  ]\r\n}\r\n\r\n// 密码表单\r\nconst passwordForm = reactive({\r\n  newPassword: '',\r\n  confirmPassword: ''\r\n})\r\n\r\nconst passwordRules = {\r\n  newPassword: [\r\n    { required: true, message: '请输入新密码', trigger: 'blur' },\r\n    { min: 6, message: '密码长度不能小于6位', trigger: 'blur' }\r\n  ],\r\n  confirmPassword: [\r\n    { required: true, message: '请再次输入新密码', trigger: 'blur' },\r\n    {\r\n      validator: (rule, value, callback) => {\r\n        if (value !== passwordForm.newPassword) {\r\n          callback(new Error('两次输入的密码不一致'))\r\n        } else {\r\n          callback()\r\n        }\r\n      },\r\n      trigger: 'blur'\r\n    }\r\n  ]\r\n}\r\n\r\n// 修改信息相关方法\r\nconst handleEdit = () => {\r\n  isEditing.value = true\r\n}\r\n\r\nconst cancelEdit = () => {\r\n  isEditing.value = false\r\n  Object.assign(infoForm, userStore.userInfo)\r\n}\r\n\r\nconst submitEdit = async () => {\r\n  if (!infoFormRef.value) return\r\n  \r\n  try {\r\n    await infoFormRef.value.validate()\r\n    loading.value = true\r\n    const res = await updateTeacherInfo(userStore.userInfo.tea_id, infoForm)\r\n    ElMessage.success('修改成功')\r\n    userStore.userInfo = res\r\n    setCookie('userInfo', JSON.stringify(res))\r\n    isEditing.value = false\r\n  } catch (error) {\r\n    ElMessage.error('修改失败')\r\n  } finally {\r\n    loading.value = false\r\n  }\r\n}\r\n\r\n// 修改密码相关方法\r\nconst submitPassword = async () => {\r\n  if (!passwordFormRef.value) return\r\n  \r\n  try {\r\n    await passwordFormRef.value.validate()\r\n    passwordLoading.value = true\r\n    await updateTeacherPassword(userStore.userInfo.tea_id, passwordForm.newPassword)\r\n    // 清理表单\r\n    passwordForm.newPassword = ''\r\n    passwordForm.confirmPassword = ''\r\n    passwordFormRef.value.resetFields()\r\n    \r\n    // 显示提示框，并在关闭后自动退出\r\n    await ElMessageBox.alert(\r\n      '密码修改成功，系统将自动退出以确保安全，请使用新密码重新登录。',\r\n      '提示',\r\n      {\r\n        type: 'success',\r\n        showClose: false,\r\n        confirmButtonText: '确定'\r\n      }\r\n    )\r\n    // 强制退出\r\n    userStore.logout()\r\n    router.push('/teacher/login')\r\n  } catch (error) {\r\n    ElMessage.error('密码修改失败')\r\n  } finally {\r\n    passwordLoading.value = false\r\n  }\r\n}\r\n\r\nconst activeTab = ref('info')  // 添加 tab 激活状态\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.settings {\r\n  .card-header {\r\n    h3 {\r\n      margin: 0;\r\n      color: #1890ff;\r\n    }\r\n  }\r\n\r\n  :deep(.el-tabs__nav-wrap::after) {\r\n    height: 1px;\r\n    background-color: #e8e8e8;\r\n  }\r\n\r\n  :deep(.el-tabs__item) {\r\n    font-size: 15px;\r\n    \r\n    &.is-active {\r\n      color: #1890ff;\r\n    }\r\n  }\r\n\r\n  :deep(.el-tabs__active-bar) {\r\n    background-color: #1890ff;\r\n  }\r\n}\r\n</style> ","import script from \"./teacher-settings.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./teacher-settings.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./teacher-settings.vue?vue&type=style&index=0&id=64eff9e0&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-64eff9e0\"]])\n\nexport default __exports__"],"names":["exports","sfc","props","target","__vccOpts","key","val","userStore","useUserStore","router","useRouter","loading","ref","passwordLoading","isEditing","infoFormRef","passwordFormRef","majors","infoForm","reactive","userInfo","infoRules","tea_phone","required","message","trigger","pattern","tea_info","max","tea_mjr","passwordForm","newPassword","confirmPassword","passwordRules","min","validator","rule","value","callback","Error","handleEdit","cancelEdit","Object","assign","submitEdit","async","validate","res","updateTeacherInfo","tea_id","ElMessage","success","setCookie","JSON","stringify","error","submitPassword","updateTeacherPassword","resetFields","ElMessageBox","alert","type","showClose","confirmButtonText","logout","push","activeTab","__exports__"],"sourceRoot":""}