{"version":3,"file":"js/834.8f154707.js","mappings":"uIAIAA,EAAQ,EAAU,CAACC,EAAKC,KACpB,MAAMC,EAASF,EAAIG,WAAaH,EAChC,IAAK,MAAOI,EAAKC,KAAQJ,EACrBC,EAAOE,GAAOC,EAElB,OAAOH,CAAM,C,iICNV,SAASI,EAAoBC,EAAWC,EAAaC,GAC1D,OAAOC,EAAAA,EAAAA,GAAQ,CACbC,IAAK,wBACLC,OAAQ,OACRC,OAAQ,CACNC,QAASL,GAEXM,KAAM,CACJC,SAAUT,EACVU,QAAST,IAGf,C,6JC8EA,MAAMU,GAAYC,EAAAA,EAAAA,KACZC,GAASC,EAAAA,EAAAA,MACTC,GAAUC,EAAAA,EAAAA,KAAI,GACdC,GAAkBD,EAAAA,EAAAA,IAAI,MACtBE,GAAoBF,EAAAA,EAAAA,IAAI,IAExBG,GAAeC,EAAAA,EAAAA,IAAS,CAC5BnB,YAAa,KAGToB,EAAgB,CACpBpB,YAAa,CACX,CAAEqB,UAAU,EAAMC,QAAS,UAAWC,QAAS,UAK7CC,EAAsBA,KAC1B,MAAMC,EAAS,GACTC,EAAU,yEAChB,IAAIC,EAAW,GAGfA,GAAY,6BAA6BC,KAAKC,MAAsB,GAAhBD,KAAKE,WACzDH,GAAY,6BAA6BC,KAAKC,MAAsB,GAAhBD,KAAKE,WACzDH,GAAY,aAAaC,KAAKC,MAAsB,GAAhBD,KAAKE,WACzCH,GAAY,WAAWC,KAAKC,MAAsB,EAAhBD,KAAKE,WAGvC,MAAOH,EAASF,OAASA,EACvBE,GAAYD,EAAQE,KAAKC,MAAMD,KAAKE,SAAWJ,EAAQD,SAIzDR,EAAkBc,MAAQJ,EAASK,MAAM,IAAIC,MAAK,IAAML,KAAKE,SAAW,KAAKI,KAAK,GAAG,EAIjFC,EAAeC,UACnB,UACQC,UAAUC,UAAUC,UAAUtB,EAAkBc,OACtDS,EAAAA,GAAUC,QAAQ,YACpB,CAAE,MAAOC,GACPF,EAAAA,GAAUG,MAAM,aAClB,GAIIC,EAAuBR,UAC3B,GAAKpB,EAAgBe,MAErB,UACQf,EAAgBe,MAAMc,WAC5B/B,EAAQiB,OAAQ,QAEVjC,EACJY,EAAUoC,SAAStC,SACnBU,EAAalB,YACbiB,EAAkBc,OAGpBS,EAAAA,GAAUC,QAAQ,qBAClB/B,EAAUqC,SACVnC,EAAOoC,KAAK,0BACd,CAAE,MAAOL,GACPH,EAAAA,GAAUG,MAAM,qBAClB,CAAE,QACA7B,EAAQiB,OAAQ,CAClB,G,OAGFkB,EAAAA,EAAAA,KAAU,KACRzB,GAAqB,I,0wEC/JvB,MAAM0B,GAA2B,OAAgB,EAAQ,CAAC,CAAC,YAAY,qBAEvE,O","sources":["webpack://gdmu-mentor-selection/./node_modules/vue-loader/dist/exportHelper.js","webpack://gdmu-mentor-selection/./src/api/admin.js","webpack://gdmu-mentor-selection/./src/views/admin/admin-settings.vue","webpack://gdmu-mentor-selection/./src/views/admin/admin-settings.vue?85f6"],"sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n// runtime helper for setting properties on components\n// in a tree-shakable way\nexports.default = (sfc, props) => {\n    const target = sfc.__vccOpts || sfc;\n    for (const [key, val] of props) {\n        target[key] = val;\n    }\n    return target;\n};\n","import request from '@/utils/request'\r\n\r\n// 更新管理员密码\r\nexport function updateAdminPassword(adminName, oldPassword, newPassword) {\r\n  return request({\r\n    url: '/api/Admin/update-pwd',\r\n    method: 'post',\r\n    params: {\r\n      new_pwd: newPassword\r\n    },\r\n    data: {\r\n      adm_name: adminName,\r\n      adm_pwd: oldPassword\r\n    }\r\n  })\r\n} ","<template>\r\n  <div class=\"settings\">\r\n    <el-card class=\"info-card\">\r\n      <template #header>\r\n        <div class=\"card-header\">\r\n          <h3>管理员信息</h3>\r\n        </div>\r\n      </template>\r\n      <el-descriptions :column=\"2\" border>\r\n        <el-descriptions-item label=\"管理员账号\">{{ userStore.userInfo?.adm_name }}</el-descriptions-item>\r\n        <el-descriptions-item label=\"管理员ID\">{{ userStore.userInfo?.adm_id }}</el-descriptions-item>\r\n      </el-descriptions>\r\n    </el-card>\r\n\r\n    <el-card class=\"password-card\">\r\n      <template #header>\r\n        <div class=\"card-header\">\r\n          <h3>密码重置</h3>\r\n        </div>\r\n      </template>\r\n\r\n      <el-form \r\n        ref=\"passwordFormRef\"\r\n        :model=\"passwordForm\"\r\n        :rules=\"passwordRules\"\r\n        label-width=\"120px\"\r\n      >\r\n        <el-form-item label=\"当前密码\" prop=\"oldPassword\">\r\n          <el-input \r\n            v-model=\"passwordForm.oldPassword\"\r\n            type=\"password\"\r\n            show-password\r\n            placeholder=\"请输入当前密码\"\r\n          />\r\n        </el-form-item>\r\n\r\n        <el-form-item label=\"新密码\">\r\n          <div class=\"password-generator\">\r\n            <el-input\r\n              v-model=\"generatedPassword\"\r\n              placeholder=\"自动生成的新密码\"\r\n              readonly\r\n            >\r\n              <template #append>\r\n                <el-button @click=\"generateNewPassword\">\r\n                  <el-icon><Refresh /></el-icon>\r\n                  重新生成\r\n                </el-button>\r\n              </template>\r\n            </el-input>\r\n            <el-button \r\n              type=\"primary\" \r\n              @click=\"copyPassword\" \r\n              :disabled=\"!generatedPassword\"\r\n            >\r\n              <el-icon><DocumentCopy /></el-icon>\r\n              复制密码\r\n            </el-button>\r\n          </div>\r\n          <div class=\"password-tip\">\r\n            <el-alert\r\n              type=\"info\"\r\n              :closable=\"false\"\r\n              show-icon\r\n            >\r\n              新密码将自动生成，包含大小写字母、数字和特殊字符，请妥善保管\r\n            </el-alert>\r\n          </div>\r\n        </el-form-item>\r\n\r\n        <el-form-item>\r\n          <el-button \r\n            type=\"primary\" \r\n            @click=\"handleUpdatePassword\"\r\n            :loading=\"loading\"\r\n            :disabled=\"!passwordForm.oldPassword || !generatedPassword\"\r\n          >\r\n            确认修改\r\n          </el-button>\r\n        </el-form-item>\r\n      </el-form>\r\n    </el-card>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, reactive, onMounted } from 'vue'\r\nimport { useUserStore } from '@/store/modules/user'\r\nimport { updateAdminPassword } from '@/api/admin'\r\nimport { ElMessage } from 'element-plus'\r\nimport { Refresh, DocumentCopy } from '@element-plus/icons-vue'\r\nimport { useRouter } from 'vue-router'\r\n\r\nconst userStore = useUserStore()\r\nconst router = useRouter()\r\nconst loading = ref(false)\r\nconst passwordFormRef = ref(null)\r\nconst generatedPassword = ref('')\r\n\r\nconst passwordForm = reactive({\r\n  oldPassword: ''\r\n})\r\n\r\nconst passwordRules = {\r\n  oldPassword: [\r\n    { required: true, message: '请输入当前密码', trigger: 'blur' }\r\n  ]\r\n}\r\n\r\n// 生成随机密码\r\nconst generateNewPassword = () => {\r\n  const length = 12\r\n  const charset = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!@#$%^&*'\r\n  let password = ''\r\n  \r\n  // 确保包含至少一个大写字母、小写字母、数字和特殊字符\r\n  password += 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'[Math.floor(Math.random() * 26)]\r\n  password += 'abcdefghijklmnopqrstuvwxyz'[Math.floor(Math.random() * 26)]\r\n  password += '0123456789'[Math.floor(Math.random() * 10)]\r\n  password += '!@#$%^&*'[Math.floor(Math.random() * 8)]\r\n  \r\n  // 填充剩余长度\r\n  while (password.length < length) {\r\n    password += charset[Math.floor(Math.random() * charset.length)]\r\n  }\r\n  \r\n  // 打乱密码顺序\r\n  generatedPassword.value = password.split('').sort(() => Math.random() - 0.5).join('')\r\n}\r\n\r\n// 复制密码\r\nconst copyPassword = async () => {\r\n  try {\r\n    await navigator.clipboard.writeText(generatedPassword.value)\r\n    ElMessage.success('密码已复制到剪贴板')\r\n  } catch (err) {\r\n    ElMessage.error('复制失败，请手动复制')\r\n  }\r\n}\r\n\r\n// 更新密码\r\nconst handleUpdatePassword = async () => {\r\n  if (!passwordFormRef.value) return\r\n  \r\n  try {\r\n    await passwordFormRef.value.validate()\r\n    loading.value = true\r\n    \r\n    await updateAdminPassword(\r\n      userStore.userInfo.adm_name,\r\n      passwordForm.oldPassword,\r\n      generatedPassword.value\r\n    )\r\n    \r\n    ElMessage.success('密码修改成功，请使用新密码重新登录')\r\n    userStore.logout()\r\n    router.push('/system-management/auth')\r\n  } catch (error) {\r\n    ElMessage.error('密码修改失败，请检查当前密码是否正确')\r\n  } finally {\r\n    loading.value = false\r\n  }\r\n}\r\n\r\nonMounted(() => {\r\n  generateNewPassword()\r\n})\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.settings {\r\n  .info-card,\r\n  .password-card {\r\n    margin-bottom: 20px;\r\n  }\r\n\r\n  .card-header {\r\n    h3 {\r\n      margin: 0;\r\n      color: #1890ff;\r\n    }\r\n  }\r\n\r\n  .password-generator {\r\n    display: flex;\r\n    gap: 12px;\r\n    align-items: center;\r\n\r\n    .el-input {\r\n      flex: 1;\r\n    }\r\n  }\r\n\r\n  .password-tip {\r\n    margin-top: 12px;\r\n  }\r\n}\r\n</style> ","import script from \"./admin-settings.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./admin-settings.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./admin-settings.vue?vue&type=style&index=0&id=29b2713d&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-29b2713d\"]])\n\nexport default __exports__"],"names":["exports","sfc","props","target","__vccOpts","key","val","updateAdminPassword","adminName","oldPassword","newPassword","request","url","method","params","new_pwd","data","adm_name","adm_pwd","userStore","useUserStore","router","useRouter","loading","ref","passwordFormRef","generatedPassword","passwordForm","reactive","passwordRules","required","message","trigger","generateNewPassword","length","charset","password","Math","floor","random","value","split","sort","join","copyPassword","async","navigator","clipboard","writeText","ElMessage","success","err","error","handleUpdatePassword","validate","userInfo","logout","push","onMounted","__exports__"],"sourceRoot":""}